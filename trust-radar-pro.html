<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Trust Radar Pro – Website Trust, UX & Security Scan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Trust Radar Pro – professional website audit for trust, UX clarity, cyber risk, and tone perception." />
  <link rel="stylesheet" href="styles.css" />
  <!-- jsPDF for PDF auto-download -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    .pill{
      display:inline-block;
      font-size:0.7rem;
      padding:3px 9px;
      border-radius:999px;
      background:rgba(34,197,94,0.12);
      color:#15803d;
      margin-bottom:6px;
    }
    .cta-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin-top:0.9rem;
    }
    .btn-note{
      font-size:0.78rem;
      color:#6b7280;
    }
    .section-eyebrow{
      font-size:0.75rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#6b7280;
      margin-bottom:0.15rem;
    }
    .section-title{
      font-size:1.1rem;
      margin:0 0 0.4rem;
      color:#111827;
    }
    .two-col{
      display:grid;
      grid-template-columns:minmax(0,1.1fr) minmax(0,1fr);
      gap:20px;
    }
    @media(max-width:900px){
      .two-col{grid-template-columns:1fr;}
    }
    .list-clean{
      padding-left:1.1rem;
      margin:0.3rem 0;
      font-size:0.86rem;
      color:#374151;
    }
    .list-clean li{margin-bottom:0.2rem;}

    /* Form */
    .pro-form{
      display:grid;
      gap:0.9rem;
    }
    .pro-form label{
      font-size:0.85rem;
      font-weight:600;
      color:#111827;
      display:block;
      margin-bottom:0.15rem;
    }
    .pro-form small{
      font-size:0.75rem;
      color:#6b7280;
      display:block;
      margin-top:0.1rem;
    }
    .pro-form input,
    .pro-form select{
      width:100%;
      padding:0.55rem 0.7rem;
      border-radius:0.6rem;
      border:1px solid rgba(148,163,184,0.9);
      font:inherit;
    }
    .inline-row{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:0.75rem;
    }
    @media(max-width:780px){
      .inline-row{grid-template-columns:1fr;}
    }

    /* Progress */
    .progress-wrap{
      margin-top:0.9rem;
      display:none;
    }
    .progress-bar-bg{
      width:100%;
      height:10px;
      border-radius:999px;
      background:#e5e7eb;
      overflow:hidden;
    }
    .progress-bar-fill{
      height:100%;
      width:0%;
      border-radius:999px;
      background:linear-gradient(90deg,#05e1fa,#22c55e);
      transition:width 0.3s ease;
    }
    .progress-text{
      font-size:0.78rem;
      color:#6b7280;
      margin-top:0.3rem;
    }

    /* Result */
    .pro-result{
      margin-top:1.2rem;
      padding:1rem 1rem 1.1rem;
      border-radius:1rem;
      background:#f9fafb;
      border:1px solid rgba(148,163,184,0.7);
      font-size:0.85rem;
    }
    .score-card{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:0.6rem;
      margin-bottom:0.8rem;
    }
    @media(max-width:780px){
      .score-card{grid-template-columns:1fr;}
    }
    .score-box{
      background:#ffffff;
      border:1px solid rgba(148,163,184,0.6);
      border-radius:0.9rem;
      padding:0.6rem;
      text-align:center;
    }
    .score-box strong{
      display:block;
      font-size:1.1rem;
      color:#040c53;
    }
    .score-box span{
      font-size:0.78rem;
      color:#6b7280;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      padding:3px 9px;
      border-radius:999px;
      font-size:0.75rem;
      margin-bottom:0.4rem;
    }
    .badge-strong{background:#dcfce7;color:#166534;}
    .badge-medium{background:#fef9c3;color:#92400e;}
    .badge-weak{background:#fee2e2;color:#991b1b;}
    .muted{
      font-size:0.78rem;
      color:#6b7280;
      margin-top:0.5rem;
    }
  </style>
</head>
<body>
<div class="page-wrapper">

  <!-- HEADER -->
  <header class="site-header">
    <div class="site-header-inner">
      <a href="index.html" class="brand">
        <div class="brand-mark">AK</div>
        <div>
          <div class="brand-text-title">Aman P Kaur</div>
          <div class="brand-text-tagline">Digital Safety · UX · AI Literacy</div>
        </div>
      </a>

      <nav class="site-nav">
        <div class="nav-links">
          <a href="index.html">Home</a>
          <a href="tools.html">Tools</a>
          <a href="services.html" class="active">Services</a>
          <a href="coaching.html">Coaching</a>
          <a href="ai.html">AI &amp; You</a>
          <a href="about.html">About</a>
          <a href="contact.html">Contact</a>
        </div>
        <a href="trust-radar-pro.html" class="btn btn-secondary nav-cta">Trust Radar Pro</a>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main>
    <div class="container">

      <!-- HERO -->
      <section class="page-hero">
        <span class="pill">Premium scan</span>
        <h1 class="page-hero-title">Trust Radar Pro</h1>
        <p class="page-hero-subtitle">
          A first-impression audit that reads your homepage like a UX and security expert –
          and shows where trust is quietly leaking.
        </p>
        <div class="page-meta">
          <span>Designed for small businesses & solo founders</span>
          <span>·</span>
          <span>One-time scan · Consultant-style report</span>
        </div>

        <div class="cta-row">
          <a class="btn btn-primary" href="https://buy.stripe.com/eVq00l7U62oCh1d695cfK02">
            Buy Trust Radar Pro (Stripe)
          </a>
          <span class="btn-note">
            After checkout, Stripe can redirect you to <code>…/trust-radar-pro.html?paid=1</code> to run your scan.
          </span>
        </div>
      </section>

      <!-- PRE-PURCHASE (marketing view) -->
      <section class="page-panel" id="pre-purchase">
        <div class="two-col">
          <div>
            <div class="section-eyebrow">What you actually get</div>
            <h2 class="section-title">Not a vanity score. A real diagnosis.</h2>
            <ul class="list-clean">
              <li>Trust, UX and perceived security scores – tied to what your homepage actually shows.</li>
              <li>Plain-English explanation of how a new visitor experiences your site in the first 10–15 seconds.</li>
              <li>Concrete “leaks”: where confidence, clarity or safety cues are missing.</li>
              <li>Top 3 moves that could genuinely change how your site performs.</li>
              <li>A clean PDF you can share with a designer, developer or partner.</li>
            </ul>
          </div>
          <div>
            <div class="section-eyebrow">How it works</div>
            <h2 class="section-title">Minimal input. The scan does the heavy lifting.</h2>
            <ol class="list-clean">
              <li><strong>Purchase via Stripe.</strong> On success, land on <code>?paid=1</code>.</li>
              <li><strong>Enter your homepage URL + a couple of basics</strong> about your business and audience.</li>
              <li><strong>Run the scan.</strong> The tool reads your homepage, scores it, and creates a PDF report.</li>
            </ol>
            <p class="muted">
              You don’t need to analyse yourself. Just drop your URL in – the tool reads the page like a first-time visitor.
            </p>
          </div>
        </div>
      </section>

      <!-- PRO TOOL (unlocked after payment) -->
      <section class="page-panel" id="pro-tool" style="display:none;">
        <div class="section-eyebrow">Unlocked</div>
        <h2 class="section-title">Run your Trust Radar Pro scan</h2>
        <p style="font-size:0.86rem;color:#374151;margin-bottom:0.7rem;">
          This scan automatically reads your homepage content and structure. You only need to tell it who you are and who you serve.
        </p>

        <form id="pro-form" class="pro-form">
          <div>
            <label for="siteUrl">Website URL (homepage)</label>
            <input id="siteUrl" type="url" required placeholder="https://example.com">
            <small>Use the URL a new visitor would land on from Google or social media.</small>
          </div>

          <div class="inline-row">
            <div>
              <label for="bizType">Business type</label>
              <select id="bizType">
                <option>Coach / Consultant</option>
                <option>Healthcare / Allied health</option>
                <option>Professional services (legal, finance, etc.)</option>
                <option>E-commerce / Online store</option>
                <option>Education / Training</option>
                <option>Community / Non-profit</option>
                <option>Other</option>
              </select>
            </div>
            <div>
              <label for="audience">Primary audience</label>
              <select id="audience">
                <option>General public</option>
                <option>Parents / families</option>
                <option>Students / young adults</option>
                <option>Professionals / B2B clients</option>
                <option>High-trust / regulated industry</option>
              </select>
            </div>
          </div>

          <button type="submit" id="scanButton" class="btn btn-primary">
            Run Pro scan & download PDF
          </button>

          <!-- Progress -->
          <div id="progressWrap" class="progress-wrap">
            <div class="progress-bar-bg">
              <div id="progressBar" class="progress-bar-fill"></div>
            </div>
            <div id="progressText" class="progress-text">Starting analysis…</div>
          </div>
        </form>

        <div id="proResult" class="pro-result" style="display:none;"></div>
        <p id="pdfNote" class="muted" style="display:none;">
          A PDF report should have downloaded automatically. If not, you can re-run the scan.
        </p>
      </section>

    </div>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="site-footer-inner">
      <div>© Aman P Kaur · Digital Safety Studio</div>
      <div class="site-footer-links">
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
        <a href="services.html">Services</a>
      </div>
    </div>
  </footer>

</div>

<script>
  // --------- GATE TOOL BY ?paid=1 ----------
  (function(){
    const params = new URLSearchParams(window.location.search);
    const paid = params.get('paid') === '1';
    const pre = document.getElementById('pre-purchase');
    const tool = document.getElementById('pro-tool');
    if (paid) {
      pre.style.display = 'none';
      tool.style.display = 'block';
    } else {
      pre.style.display = 'block';
      tool.style.display = 'none';
    }
  })();

  const form = document.getElementById('pro-form');
  const resultBox = document.getElementById('proResult');
  const progressWrap = document.getElementById('progressWrap');
  const progressBar = document.getElementById('progressBar');
  const progressText = document.getElementById('progressText');
  const scanButton = document.getElementById('scanButton');
  const pdfNote = document.getElementById('pdfNote');

  function clamp(num,min,max){return Math.min(max,Math.max(min,num));}

  // Fetch site HTML via a public CORS proxy (best-effort)
  function fetchSiteHtml(url){
    const proxied = "https://api.allorigins.win/raw?url=" + encodeURIComponent(url);
    return fetch(proxied,{cache:"no-store"})
      .then(res => {
        if(!res.ok) throw new Error("Network error");
        return res.text();
      })
      .catch(err => {
        console.error("Fetch failed, falling back to URL-only analysis", err);
        return null; // we'll handle gracefully
      });
  }

  form && form.addEventListener('submit', function(e){
    e.preventDefault();

    const siteUrl = document.getElementById('siteUrl').value.trim();
    if(!siteUrl){
      alert('Please enter your website URL.');
      return;
    }

    const bizType = document.getElementById('bizType').value;
    const audience = document.getElementById('audience').value;

    // progress UI
    scanButton.disabled = true;
    scanButton.textContent = 'Scanning your site…';
    progressWrap.style.display = 'block';
    resultBox.style.display = 'none';
    pdfNote.style.display = 'none';
    progressBar.style.width = '0%';
    progressText.textContent = 'Reaching your homepage…';

    const steps = [
      'Reaching your homepage…',
      'Reading headings, forms and key text…',
      'Evaluating trust signals and social proof…',
      'Assessing clarity, calls-to-action and tone…',
      'Reviewing data & security cues…',
      'Composing your report…'
    ];
    let step = 0;
    const interval = setInterval(()=>{
      step++;
      const pct = clamp((step/steps.length)*90,0,90); // leave last 10% for after analysis
      progressBar.style.width = pct + '%';
      progressText.textContent = steps[Math.min(step-1,steps.length-1)];
      if(step>=steps.length){
        clearInterval(interval);
      }
    }, 600);

    // Fetch + analyse
    fetchSiteHtml(siteUrl).then(html => {
      const report = analyseSite({
        siteUrl,
        bizType,
        audience,
        html
      });
      progressBar.style.width = '100%';
      progressText.textContent = 'Finalising your Trust Radar report…';
      showResults(report);
      generatePdf(report);
      scanButton.disabled = false;
      scanButton.textContent = 'Run Pro scan & download PDF';
    });
  });

  // ---------- ANALYSIS ENGINE ----------
  function analyseSite(input){
    let trustScore = 60;
    let securityScore = 60;
    let uxScore = 60;

    const { siteUrl, bizType, audience, html } = input;

    let title = '';
    let metaDesc = '';
    let h1Text = '';
    let allText = '';
    let hasForm = false;
    let hasPrivacy = false;
    let hasTerms = false;
    let hasTestimonials = false;
    let hasStars = false;
    let hasLogosWords = false;
    let hasAboutLink = false;
    let hasContactLink = false;
    let hasPriceWords = false;
    let hasPaymentWords = false;
    let ctaTexts = [];

    if(html){
      try{
        const parser = new DOMParser();
        const doc = parser.parseFromString(html,"text/html");

        // title & description
        const titleEl = doc.querySelector('title');
        if(titleEl) title = titleEl.textContent.trim();

        const metaEl = doc.querySelector('meta[name="description"]');
        if(metaEl) metaDesc = metaEl.getAttribute('content') || '';

        // hero H1
        const h1El = doc.querySelector('h1');
        if(h1El) h1Text = h1El.textContent.trim();

        // texts
        allText = (doc.body ? doc.body.innerText || '' : html).toLowerCase();

        // forms
        hasForm = !!doc.querySelector('form');

        // CTAs
        const buttons = Array.from(doc.querySelectorAll('button, a'));
        ctaTexts = buttons
          .map(b => (b.textContent || '').trim())
          .filter(t => t.length >= 3 && t.length <= 40)
          .slice(0, 12); // keep it light

        // signals via text search
        const t = allText;

        hasPrivacy = t.includes('privacy policy') || t.includes('privacy') || t.includes('gdpr');
        hasTerms = t.includes('terms of use') || t.includes('terms and conditions') || t.includes('terms & conditions');
        hasTestimonials = t.includes('testimonial') || t.includes('testimonials') || t.includes('what our clients say') || t.includes('success stories') || t.includes('reviews');
        hasStars = t.includes('★★★★★') || t.includes('4.8/5') || t.includes('4.9/5') || t.includes('google reviews');
        hasLogosWords = t.includes('as seen in') || t.includes('featured in') || t.includes('trusted by');
        hasAboutLink = t.includes('about us') || t.includes('about me') || t.includes('who we are');
        hasContactLink = t.includes('contact') || t.includes('get in touch') || t.includes('reach out');
        hasPriceWords = t.includes('pricing') || t.includes('prices') || t.includes('investment') || t.includes('from $') || t.includes('starting at');
        hasPaymentWords = t.includes('stripe') || t.includes('paypal') || t.includes('visa') || t.includes('mastercard') || t.includes('afterpay') || t.includes('shop pay');

      }catch(err){
        console.error("DOM parse error, falling back to text-only analysis", err);
      }
    }

    // Use H1 or title as core message
    const coreHeadline = h1Text || title || '';
    const coreLower = coreHeadline.toLowerCase();

    // ---------- TRUST ----------
    if(hasTestimonials) trustScore += 10; else trustScore -= 8;
    if(hasStars) trustScore += 6;
    if(hasLogosWords) trustScore += 5;
    if(hasAboutLink) trustScore += 4; else trustScore -= 3;
    if(hasContactLink) trustScore += 3;

    if(!hasPriceWords && (bizType.includes('Coach') || bizType.includes('Professional'))) {
      trustScore -= 4; // feels more opaque
    }

    // higher bar for certain segments
    if(bizType.includes('Healthcare') || audience === 'High-trust / regulated industry') {
      trustScore -= 5;
    }

    // ---------- SECURITY / PERCEIVED DATA CARE ----------
    if(hasForm) securityScore -= 3;
    if(hasPrivacy) securityScore += 10;
    if(hasTerms) securityScore += 4;
    if(!hasPrivacy && hasForm) securityScore -= 10;

    if(hasPaymentWords) {
      securityScore -= 5; // extra responsibility
      // if they mention Stripe/PayPal etc, also add a bit back as positive
      if(allText.includes('stripe') || allText.includes('paypal')){
        securityScore += 4;
      }
    }

    if(bizType.includes('Healthcare') || audience === 'High-trust / regulated industry') {
      securityScore -= 5;
    }

    // ---------- UX CLARITY ----------
    let mainCtaText = '';
    if(ctaTexts.length){
      // pick the first non-generic CTA
      mainCtaText = ctaTexts[0];
    }

    const ctaLower = (mainCtaText || '').toLowerCase();

    if(!coreHeadline) {
      uxScore -= 10;
    } else {
      // Does headline mention who it's for?
      const mentionsWho = coreLower.includes('for ') || coreLower.includes('parents') || coreLower.includes('business') || coreLower.includes('clients') || coreLower.includes('students') || coreLower.includes('teams') || coreLower.includes('women') || coreLower.includes('men');
      const mentionsOutcome = coreLower.includes('so you') || coreLower.includes('to help you') || coreLower.includes('feel') || coreLower.includes('grow') || coreLower.includes('safer') || coreLower.includes('confident') || coreLower.includes('results');

      if(mentionsWho) uxScore += 5; else uxScore -= 5;
      if(mentionsOutcome) uxScore += 5; else uxScore -= 4;

      if(coreHeadline.length < 40) uxScore -= 4;
      if(coreHeadline.length > 140) uxScore -= 4;
    }

    if(mainCtaText){
      if(ctaLower.includes('learn more') || ctaLower.includes('read more')){
        uxScore -= 6; // vague
      } else if(ctaLower.includes('book') || ctaLower.includes('start') || ctaLower.includes('schedule') || ctaLower.includes('get started')){
        uxScore += 6;
      }
    } else {
      uxScore -= 6; // no clear action
    }

    // E-com: need clarity on product / checkout
    if(bizType.includes('E-commerce')){
      if(!hasPriceWords) uxScore -= 5;
      if(!hasPaymentWords) uxScore -= 3;
    }

    trustScore = clamp(trustScore, 10, 95);
    securityScore = clamp(securityScore, 10, 95);
    uxScore = clamp(uxScore, 10, 95);

    const overall = Math.round((trustScore + securityScore + uxScore)/3);

    let band, bandClass, verdict;
    if(overall >= 80){
      band = 'Strong baseline with specific sharp edges to polish.';
      bandClass = 'badge-strong';
      verdict = 'Your site feels basically trustworthy, but a few details are still quietly costing you conversions and confidence.';
    } else if(overall >= 60){
      band = 'Workable but leaking trust, clarity or safety cues.';
      bandClass = 'badge-medium';
      verdict = 'A motivated visitor can work out what you do, but you are making them think and trust more than you should.';
    } else {
      band = 'High hesitation risk for new visitors.';
      bandClass = 'badge-weak';
      verdict = 'A new visitor is likely to feel unsure: what you do, whether you are legitimate, and what they should do next are not immediately obvious.';
    }

    // ---------- TOP FIXES ----------
    const priorityFixes = [];
    const trustFixes = [];
    const securityFixes = [];
    const uxFixes = [];

    // Trust fixes
    if(!hasTestimonials){
      trustFixes.push('Add at least one specific testimonial above the fold: who you helped, what changed, and roughly how long it took.');
    }
    if(hasTestimonials && !hasStars && !hasLogosWords){
      trustFixes.push('Layer your testimonials with simple proof, such as logos, a “trusted by” strip, or a short rating summary.');
    }
    if(!hasAboutLink){
      trustFixes.push('Make an “About” or “Who I am” link easy to spot so visitors can connect your services to a real person or team.');
    }
    if(!hasPriceWords && (bizType.includes('Coach') || bizType.includes('Professional'))){
      trustFixes.push('Add a “What to expect” snippet: rough pricing, formats or timeframes so people don’t feel they are stepping into a mystery.');
    }

    // Security fixes
    if(hasForm && !hasPrivacy){
      securityFixes.push('Near any form, add a one-sentence data note in plain language: what you collect, what you use it for, and that you don’t sell it.');
    }
    if(hasPaymentWords && !hasPrivacy){
      securityFixes.push('If you take payments, clearly name your payment provider (e.g. Stripe) and say that card details are handled securely by them, not stored on your website.');
    }
    if((bizType.includes('Healthcare') || audience === 'High-trust / regulated industry') && !hasPrivacy){
      securityFixes.push('For sensitive audiences, link to a simple privacy or “how we handle your information” page from the homepage.');
    }

    // UX fixes
    if(!coreHeadline){
      uxFixes.push('Add a clear headline that says who you help and what changes for them in one or two short lines.');
    } else {
      if(coreHeadline.length > 140){
        uxFixes.push('Trim your main message into a headline + subheading so a busy visitor can scan it in 3–4 seconds.');
      }
      const coreLower2 = coreHeadline.toLowerCase();
      const mentionsWho = coreLower2.includes('for ') || coreLower2.includes('parents') || coreLower2.includes('business') || coreLower2.includes('students');
      const mentionsOutcome = coreLower2.includes('so you') || coreLower2.includes('to help you') || coreLower2.includes('feel') || coreLower2.includes('results');
      if(!mentionsWho || !mentionsOutcome){
        uxFixes.push('Rewrite your headline to follow a simple pattern: “I help [who] to [outcome] without [pain or barrier where relevant]”.');
      }
    }

    if(!mainCtaText){
      uxFixes.push('Choose one primary call-to-action (e.g. “Book a 15-min call”) and make that the clearest, most visible button on the page.');
    } else if(mainCtaText && (ctaLower.includes('learn more') || ctaLower.includes('read more'))){
      uxFixes.push('Change your main button text from “Learn more” to a commitment-based action like “Book a consult” or “Start your intake”.');
    }

    // pick top 3 (one from each category if possible)
    if(trustFixes[0]) priorityFixes.push(trustFixes[0]);
    if(uxFixes[0]) priorityFixes.push(uxFixes[0]);
    if(securityFixes[0]) priorityFixes.push(securityFixes[0]);

    if(priorityFixes.length < 3){
      // fill with any remaining
      const extras = [...trustFixes.slice(1), ...uxFixes.slice(1), ...securityFixes.slice(1)];
      for(const x of extras){
        if(priorityFixes.length >= 3) break;
        priorityFixes.push(x);
      }
    }

    // 7-day plan is generic but tied to fixes
    const sevenDayPlan = [
      'Day 1–2: Implement one trust improvement (e.g. move a strong testimonial or proof element into the top section of your homepage).',
      'Day 3–4: Refine your headline and main button so that who you help and what happens next are clear at a glance.',
      'Day 5: Add or update a short privacy / data-care note anywhere you collect information, especially if you use forms or take payments.',
      'Day 6: Open your homepage on a mobile phone and check if your headline and main button are still easy to read and tap.',
      'Day 7: Ask one non-technical friend to visit your homepage and tell you, in their own words, who they think it is for and what they would click first.'
    ];

    return {
      siteUrl,
      bizType,
      audience,
      title,
      metaDesc,
      coreHeadline,
      mainCtaText,
      trustScore,
      securityScore,
      uxScore,
      overall,
      band,
      bandClass,
      verdict,
      priorityFixes,
      trustFixes,
      securityFixes,
      uxFixes,
      sevenDayPlan
    };
  }

  // ---------- SHOW RESULTS ----------
  function showResults(r){
    const {
      siteUrl,bizType,audience,
      coreHeadline,mainCtaText,
      trustScore,securityScore,uxScore,overall,
      band,bandClass,verdict,
      priorityFixes,trustFixes,securityFixes,uxFixes
    } = r;

    resultBox.innerHTML = `
      <div class="badge ${bandClass}">${band}</div>
      <p><strong>Site:</strong> ${siteUrl}</p>
      <p><strong>Context:</strong> ${bizType} • ${audience}</p>

      <div class="score-card">
        <div class="score-box">
          <strong>${trustScore}</strong>
          <span>Trust & legitimacy</span>
        </div>
        <div class="score-box">
          <strong>${securityScore}</strong>
          <span>Perceived security & data care</span>
        </div>
        <div class="score-box">
          <strong>${uxScore}</strong>
          <span>UX clarity & next-step confidence</span>
        </div>
      </div>

      <p><strong>Overall verdict:</strong> ${verdict}</p>

      <p><strong>First-impression message detected:</strong> ${
        coreHeadline ? `"${coreHeadline}"` : 'No clear headline detected.'
      }</p>
      <p><strong>Main action detected:</strong> ${
        mainCtaText ? `"${mainCtaText}"` : 'No obvious main call-to-action found.'
      }</p>

      <h4 style="margin-top:0.7rem;">Top 3 priority moves</h4>
      <ul class="list-clean">
        ${
          priorityFixes.length
            ? priorityFixes.map(x=>`<li>${x}</li>`).join('')
            : '<li>No single urgent issue surfaced. Focus on sharpening proof, privacy signals and one clear call-to-action.</li>'
        }
      </ul>

      <h4>Trust & legitimacy focus</h4>
      <ul class="list-clean">
        ${
          trustFixes.length
            ? trustFixes.map(x=>`<li>${x}</li>`).join('')
            : '<li>Your trust layer looks reasonable from a quick scan. Next, focus on making proof specific (who, what changed, in roughly how long).</li>'
        }
      </ul>

      <h4>Security & data handling focus</h4>
      <ul class="list-clean">
        ${
          securityFixes.length
            ? securityFixes.map(x=>`<li>${x}</li>`).join('')
            : '<li>No major visible trust gaps were flagged in how you present data and security. Still, plan a yearly review of your privacy and data wording.</li>'
        }
      </ul>

      <h4>UX clarity & next-step focus</h4>
      <ul class="list-clean">
        ${
          uxFixes.length
            ? uxFixes.map(x=>`<li>${x}</li>`).join('')
            : '<li>Your homepage looks broadly clear on first pass. Future gains will come from refining wording, hierarchy and accessibility rather than big structural changes.</li>'
        }
      </ul>
    `;
    resultBox.style.display = 'block';
    pdfNote.style.display = 'block';
  }

  // ---------- PDF GENERATION ----------
  function generatePdf(r){
    try{
      const { jsPDF } = window.jspdf || {};
      if(!jsPDF) return;
      const doc = new jsPDF({unit:'pt',format:'a4'});
      const margin = 40;
      let y = margin;

      function addHeading(text,size=14,gap=18){
        doc.setFont('helvetica','bold');
        doc.setFontSize(size);
        doc.text(text,margin,y);
        y += gap;
      }
      function addBody(text,size=11,gap=14){
        doc.setFont('helvetica','normal');
        doc.setFontSize(size);
        const lines = doc.splitTextToSize(text,515);
        doc.text(lines,margin,y);
        y += gap + (lines.length-1)*size*0.9;
      }
      function addList(items){
        doc.setFont('helvetica','normal');
        doc.setFontSize(11);
        items.forEach(item=>{
          const lines = doc.splitTextToSize('• '+item,515);
          if(y + lines.length*12 > 780){
            doc.addPage(); y = margin;
          }
          doc.text(lines,margin,y);
          y += 14;
        });
        y += 4;
      }
      function newPageIfNeeded(extra=80){
        if(y + extra > 780){
          doc.addPage(); y = margin;
        }
      }

      const {
        siteUrl,bizType,audience,
        coreHeadline,mainCtaText,
        trustScore,securityScore,uxScore,overall,
        band,verdict,
        priorityFixes,trustFixes,securityFixes,uxFixes,
        sevenDayPlan
      } = r;

      // Cover
      addHeading('Trust Radar Pro – Website Report',16,22);
      addBody('Site: '+siteUrl);
      addBody('Business type: '+bizType+' | Audience: '+audience);
      addBody('Overall read: '+band+' (overall score: '+overall+'/100)');
      newPageIfNeeded();

      // Scores
      addHeading('1. Score snapshot',14,18);
      addBody('Trust & legitimacy: '+trustScore+'/100');
      addBody('Perceived security & data care: '+securityScore+'/100');
      addBody('UX clarity & next-step confidence: '+uxScore+'/100');
      addBody('Professional verdict: '+verdict);
      newPageIfNeeded();

      // First impression
      addHeading('2. First-impression message & action',14,18);
      addBody('Headline detected: ' + (coreHeadline || '(No clear headline detected – consider adding one that names who you help and what changes for them.)'));
      addBody('Main action detected: ' + (mainCtaText || '(No obvious main call-to-action found – consider one clear next step, like “Book a 15-min call”.)'));
      newPageIfNeeded();

      // Priority moves
      addHeading('3. Top 3 priority moves',14,18);
      if(priorityFixes.length) addList(priorityFixes);
      else addBody('No single urgent issue surfaced. Focus on sharpening proof, privacy signals and one clear main action.');
      newPageIfNeeded();

      // Trust
      addHeading('4. Trust & legitimacy layer',14,18);
      if(trustFixes.length) addList(trustFixes);
      else addBody('Your trust layer appears reasonable at a glance. Deepen it with outcome-based testimonials, more specific stories, and simple proof such as logos or ratings where appropriate.');
      newPageIfNeeded();

      // Security
      addHeading('5. Security & data handling signals',14,18);
      if(securityFixes.length) addList(securityFixes);
      else addBody('No major visible gaps were flagged from a visitor perspective. Still, ensure that privacy and data-handling wording is up to date and easy to find from your homepage.');
      newPageIfNeeded();

      // UX
      addHeading('6. UX clarity & next-step confidence',14,18);
      if(uxFixes.length) addList(uxFixes);
      else addBody('Your homepage structure looks broadly clear. Future improvements may focus on language sharpness, page hierarchy and mobile readability.');
      newPageIfNeeded();

      // 7-day plan
      addHeading('7. Simple 7-day action plan',14,18);
      addList(sevenDayPlan);

      doc.save('trust-radar-report.pdf');
    }catch(err){
      console.error('PDF generation error',err);
    }
  }
</script>
</body>
</html>
